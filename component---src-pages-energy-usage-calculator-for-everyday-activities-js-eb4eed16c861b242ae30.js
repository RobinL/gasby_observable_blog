(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{234:function(e,n,t){"use strict";t.r(n);t(0);var i=t(1),r=t.n(i),a=(t(32),t(56));t(20),t(28);function o(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}t(125),t(126),t(7),t(2),t(78),t(69);var u=t(95),l=t(153);function c(){var e=o(["<input type=number min=0 max=100 step=1>"]);return c=function(){return e},e}function f(){var e=o(["<input type=range min=0 max=100 step=1>"]);return f=function(){return e},e}function d(){var e=o(["Here are two more inputs (of different types!) bound to the same view. Interacting with either view below updates *y* as well as the other synchronized inputs above."]);return d=function(){return e},e}function s(){var e=o(["Since we want multiple controls, instead of duplicating the code above, let’s now write a reusable function that binds a given input to a given view. We use [Generators.disposable](https://github.com/observablehq/notebook-stdlib/blob/master/README.md#Generators_disposable) to remove the event listener from the view when the calling cell is [invalidated](/@mbostock/disposing-content)."]);return s=function(){return e},e}function v(){var e=o(["<input type=range min=0 max=100 step=1>"]);return v=function(){return e},e}function h(){var e=o(["And now let’s define an input that both listens to the minimal view and assigns a new value on interaction. Notice that dragging the slider changes the value of *y*."]);return h=function(){return e},e}function m(){var e=o(["Here’s our view’s value:"]);return m=function(){return e},e}function p(){var e=o(["Now let’s define a minimal view whose initial value is 42:"]);return p=function(){return e},e}function _(){var e=o(["While each interactive value is often independent, other times multiple controls manipulate a shared value. This requires synchronizing views such that interaction with any one view updates both the interactive value and the other views.\n\nOne way to synchronize is to treat [views as mutable values](/@mbostock/views-are-mutable-values): make one view the “primary” view, and have the other “secondary” views listen to and mutate the primary view. But sometimes it isn’t obvious which view should be primary.\n\nA more general approach is a *minimal* view: a container for a mutable value that implements the [EventTarget interface](https://developer.mozilla.org/docs/Web/API/EventTarget), making it compatible with `viewof`. This minimal view also exposes a *view*.value property representing its current value; setting the value causes the view to dispatch an *input* event, which in turn causes Observable to [rerun](/@mbostock/how-observable-runs) any referencing cells."],["While each interactive value is often independent, other times multiple controls manipulate a shared value. This requires synchronizing views such that interaction with any one view updates both the interactive value and the other views.\n\nOne way to synchronize is to treat [views as mutable values](/@mbostock/views-are-mutable-values): make one view the “primary” view, and have the other “secondary” views listen to and mutate the primary view. But sometimes it isn’t obvious which view should be primary.\n\nA more general approach is a *minimal* view: a container for a mutable value that implements the [EventTarget interface](https://developer.mozilla.org/docs/Web/API/EventTarget), making it compatible with \\`viewof\\`. This minimal view also exposes a *view*.value property representing its current value; setting the value causes the view to dispatch an *input* event, which in turn causes Observable to [rerun](/@mbostock/how-observable-runs) any referencing cells."]);return _=function(){return e},e}function w(){var e=o(["<input type=range>"]);return w=function(){return e},e}function g(){var e=o(["# Synchronized Views\n\n[A view](/@mbostock/introduction-to-views) conveniently defines an interactive value."]);return g=function(){return e},e}function b(e,n){var t=e.module();return t.variable(n()).define(["md"],(function(e){return e(g())})),t.variable(n("viewof x")).define("viewof x",["html"],(function(e){return e(w())})),t.variable(n("x")).define("x",["Generators","viewof x"],(function(e,n){return e.input(n)})),t.variable(n()).define(["x"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e(_())})),t.variable(n("View")).define("View",(function(){return function(){function e(n){Object(u.a)(this,e),Object.defineProperties(this,{_list:{value:[],writable:!0},_value:{value:n,writable:!0}})}return Object(l.a)(e,[{key:"addEventListener",value:function(e,n){"input"!=e||this._list.includes(n)||(this._list=[n].concat(this._list))}},{key:"removeEventListener",value:function(e,n){"input"==e&&(this._list=this._list.filter((function(e){return e!==n})))}},{key:"dispatchEvent",value:function(e){var n=Promise.resolve(e);this._list.forEach((function(e){return n.then(e)}))}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.dispatchEvent({type:"input",value:e})}}]),e}()})),t.variable(n()).define(["md"],(function(e){return e(p())})),t.variable(n("viewof y")).define("viewof y",["View"],(function(e){return new e(42)})),t.variable(n("y")).define("y",["Generators","viewof y"],(function(e,n){return e.input(n)})),t.variable(n()).define(["md"],(function(e){return e(m())})),t.variable(n()).define(["y"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e(h())})),t.variable(n()).define(["html","viewof y","invalidation"],(function(e,n,t){var i=e(v());i.oninput=function(){return n.value=i.valueAsNumber};var r=function(){return i.value=n.value};return n.addEventListener("input",r),t.then((function(){return n.removeEventListener("input",r)})),r(),i})),t.variable(n()).define(["md"],(function(e){return e(s())})),t.variable(n("bind")).define("bind",["Generators"],(function(e){return function(n,t){function i(e){var t=e.value;isNaN(t)||n.valueAsNumber===t||(n.value=t)}return n.value=t.value,n.oninput=function(){return t.value=n.valueAsNumber},t.addEventListener("input",i),e.disposable(n,(function(){t.removeEventListener("input",i)}))}})),t.variable(n()).define(["md"],(function(e){return e(d())})),t.variable(n()).define(["bind","html","viewof y"],(function(e,n,t){return e(n(f()),t)})),t.variable(n()).define(["bind","html","viewof y"],(function(e,n,t){return e(n(c()),t)})),t.variable(n()).define(["y"],(function(e){return e})),t}t(22),t(167);function y(){var e=o(["<span>"]);return y=function(){return e},e}function k(){var e=o(["This is a test; the count should be three.\n\n",""]);return k=function(){return e},e}function x(){var e=o(["# Disposal\n\nThis is a little helper to detect when an element is removed from the DOM. It functions similarly to [invalidation](https://github.com/observablehq/notebook-stdlib/blob/master/README.md#invalidation), except that you don’t need to pass the invalidation promise around. The downside is that it only works if the resource you want to dispose is attached to a DOM element."]);return x=function(){return e},e}function A(e,n){var t=e.module();return t.variable(n()).define(["md"],(function(e){return e(x())})),t.variable(n("disposal")).define("disposal",["MutationObserver"],(function(e){return function(n){return new Promise((function(t){requestAnimationFrame((function(){var i=n.closest(".observablehq");if(!i)return t();var r=new e((function(e){i.contains(n)||(r.disconnect(),t())}));r.observe(i,{childList:!0})}))}))}})),t.variable(n()).define(["md","test"],(function(e,n){return e(k(),Array.from({length:3},n))})),t.define("initial count",(function(){return 0})),t.variable(n("mutable count")).define("mutable count",["Mutable","initial count"],(function(e,n){return new e(n)})),t.variable(n("count")).define("count",["mutable count"],(function(e){return e.generator})),t.variable(n("test")).define("test",["html","mutable count","disposal"],(function(e,n,t){return function(){var i=e(y());return++n.value,t(i).then((function(){return--n.value})),i}})),t}function V(){var e=o(["To bind a given *input* to a *view*, you need bidirectional listening: the *input* needs to listen to the *view* (to update the *input*’s value), and the *view* needs to listen to the *input* (to update the *view*’s value). This is a [disposable view](/@mbostock/disposal)."]);return V=function(){return e},e}function G(){var e=o(["The view’s value can be referenced reactively:"]);return G=function(){return e},e}function S(){var e=o(["All of these inputs are synchronized using a [view](/@mbostock/synchronized-views):"]);return S=function(){return e},e}function D(){var e=o(["<input type=range>"]);return D=function(){return e},e}function j(){var e=o(["You can also do a standalone input:"]);return j=function(){return e},e}function T(){var e=o(['<input type=number style="width:80px;">']);return T=function(){return e},e}function E(){var e=o(['<input type=range style="width:80px;">']);return E=function(){return e},e}function L(){var e=o(["This is a range input ",".\n\nThis is a number input ","."]);return L=function(){return e},e}function q(){var e=o(["# Inline Inputs\n\nSometimes you might want to put inputs inline in your Markdown, rather than as separate cells. This is a little trickier, but possible, and you can even synchronize multiple inputs if you desire. Here’s an example:"]);return q=function(){return e},e}function O(e,n){var t=e.module();t.variable(n()).define(["md"],(function(e){return e(q())})),t.variable(n()).define(["md","bind","html","viewof apples"],(function(e,n,t,i){return e(L(),n(t(E()),i),n(t(T()),i))})),t.variable(n()).define(["md"],(function(e){return e(j())})),t.variable(n()).define(["bind","html","viewof apples"],(function(e,n,t){return e(n(D()),t)})),t.variable(n()).define(["md"],(function(e){return e(S())})),t.variable(n("viewof apples")).define("viewof apples",["View"],(function(e){return new e(3)})),t.variable(n("apples")).define("apples",["Generators","viewof apples"],(function(e,n){return e.input(n)})),t.variable(n()).define(["md"],(function(e){return e(G())})),t.variable(n()).define(["apples"],(function(e){return new Array(e+1).join("🍎")})),t.variable(n()).define(["md"],(function(e){return e(V())})),t.variable(n("bind")).define("bind",["disposal"],(function(e){return function(n,t){var i=["range","number"].includes(n.type)?"valueAsNumber":"value",r=function(){return n[i]=t.value};return n.oninput=function(){return t.value=n[i]},t.addEventListener("input",r),e(n).then((function(){return t.removeEventListener("input",r)})),r(),n}}));var i=e.module(b);t.import("View",i);var r=e.module(A);return t.import("disposal",r),t}function N(){var e=o(['<select>\n    <option value="minutes">minute</option>\n    <option value="hours">hour</option>\n    <option value="days">day</option>\n    <option value="weeks">week</option>\n    <option value="months">month</option>\n    <option value="years">year</option>\n  </select>']);return N=function(){return e},e}function z(){var e=o(["<input type=",' style="width:',';">']);return z=function(){return e},e}function I(){var e=o(["# Utils"]);return I=function(){return e},e}function R(e,n){var t=e.module();t.variable(n()).define(["md"],(function(e){return e(I())})),t.variable(n("inline_input")).define("inline_input",["bind","html"],(function(e,n){return function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"25px";return e(n(z(),i,r),t)}}));var i=e.module(O);return t.import("bind",i),t.import("View",i),t.variable(n("time_period_picker")).define("time_period_picker",["bind","html"],(function(e,n){return function(t){return e(n(N()),t)}})),t}t(166),t(238),t(165),t(14),t(8),t(79),t(40);function P(){var e=o(['Each full square ( <svg width=16 height=16><rect x="0" y="0" width="16" height="16" fill="#BBB" stroke="gray"></rect></svg> ) in the visualisations represents 1 kilowatt hour (kwh), the amount of energy consumed by using 1000 watts of power for one hour.  ']);return P=function(){return e},e}function M(){var e=o(["<input type=range min=0 max=50 step=0.25>"]);return M=function(){return e},e}function W(){var e=o(["# Unit chart"]);return W=function(){return e},e}function F(e,n){var t=e.module();return t.variable(n()).define(["md"],(function(e){return e(W())})),t.variable(n("d3")).define("d3",["require"],(function(e){return e("d3","d3-scale-chromatic@^1.4.0")})),t.variable(n("data")).define("data",["slider"],(function(e){return{"label a":15.5,"b stuff":42.2,"c another label":e}})),t.variable(n("get_d3_data")).define("get_d3_data",(function(){return function(e){var n=Object.keys(e).map((function(n){return{key:n,value:e[n]}}));return n.sort((function(e,n){return n.value-e.value})),n.map((function(e){var n=e.value,t=Math.ceil(n),i=Array(t).fill(0);return i=i.map((function(t,i){return{key:e.key,value:i+1>n?n-i:1}}))})).flat()}})),t.variable(n("viewof slider")).define("viewof slider",["html"],(function(e){return e(M())})),t.variable(n("slider")).define("slider",["Generators","viewof slider"],(function(e,n){return e.input(n)})),t.variable(n("d3_data")).define("d3_data",["get_d3_data","data"],(function(e,n){return e(n)})),t.variable(n()).define(["unit_chart","data","width"],(function(e,n,t){return e(n,t)})),t.variable(n("unit_chart")).define("unit_chart",["width","get_d3_data","d3","DOM"],(function(e,n,t,i){return function(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(){a>640&o&&(a=640);var e=n(r),u=0,l=20,c=0,f=0,d=a-f-l,s=e.reduce((function(e,n){return e+n.value}),0),v=Math.floor(d/20),h=20*Math.ceil(s/v),m=v-s%v<7,p=0;m&&(p=20);var _=h+p+u+c-u-c,w=t.scaleOrdinal().range(t.schemeCategory10).domain(["Driving","Flying","Heating","Stuff","Showers","Food/Eating","Washing machine","Dishwasher","Dogs"]),g=t.select(i.svg(d+f+l,_+u+c)),b=g.append("g").attr("transform","translate("+f+","+u+")");b.selectAll("c_rect").data(e).enter().append("rect").attr("x",(function(e,n){return n%v*20})).attr("y",(function(e,n){return 20*Math.floor(n/v)})).attr("width",(function(e){return 16*e.value})).attr("height",16).attr("fill",(function(e){return w(e.key)})),b.selectAll("g_rect").data(e).enter().append("rect").attr("x",(function(e,n){return n%v*20})).attr("y",(function(e,n){return 20*Math.floor(n/v)})).attr("width",(function(e){return 16})).attr("height",16).attr("stroke","gray").attr("stroke-width",.5).attr("fill","none");var y=e.reduce((function(e,n){return e+n.value}),0).toFixed(1)+" kwh/day",k=0;m||(k=(e.length-1)%v*20+20);var x=20*Math.floor((e.length-1)/v);return m&&(x+=20),b.append("text").attr("x",k).attr("dx",2).attr("y",x).attr("dy",10).style("text-anchor","left").style("alignment-baseline","middle").style("font-size","1em").text(y),g.node()}()}})),t.variable(n("unit_chart_2")).define("unit_chart_2",["width","get_d3_data","munge_data","d3","DOM"],(function(e,n,t,i,r){return function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,u=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(){o>640&u&&(o=640);var e=n(a),l=0,c=20,f=0,d=100,s=o-d-c,v=(e.reduce((function(e,n){return e+n.value}),0),Math.floor(s/20)),h=t(e,v),m=i.nest().key((function(e){return e.key})).rollup((function(e){return i.extent(e,(function(e){return e.y}))})).entries(h),p=20*(h.slice(-1)[0].y+1)+l+f-l-f,_=i.scaleOrdinal().range(i.schemeCategory10).domain(["Driving","Flying","Heating","Stuff","Showers","Food/Eating","Washing machine","Dishwasher","Dogs"]),w=i.select(r.svg(s+d+c,p+l+f)),g=w.append("g").attr("transform","translate("+d+","+l+")");return g.selectAll("c_rect").data(h).enter().append("rect").attr("x",(function(e){return 20*e.x})).attr("y",(function(e){return 20*e.y})).attr("width",(function(e){return 16*e.value})).attr("height",16).attr("fill",(function(e){return _(e.key)})),g.selectAll("a_text").data(m).enter().append("text").attr("x",0).attr("dx",-4).attr("y",(function(e){return 20*i.mean(e.value)})).attr("dy",10).style("text-anchor","end").style("alignment-baseline","middle").style("font-size","1em").text((function(e){return e.key})),w.node()}()}})),t.variable(n()).define(["unit_chart_2","data","width"],(function(e,n,t){return e(n,t)})),t.variable(n("munge_data")).define("munge_data",(function(){return function(e,n){var t=0,i=0,r=e[0].key;return e.map((function(e){return r!=e.key?(i+=1,t=0):t>n&&(t=0,i+=1),e.x=t,e.y=i,r=e.key,t+=1,e}))}})),t.variable(n("munged")).define("munged",["munge_data","get_d3_data","data"],(function(e,n,t){return e(n(t),10)})),t.variable(n("text_positions")).define("text_positions",["d3","munged"],(function(e,n){return e.nest().key((function(e){return e.key})).rollup((function(n){return e.extent(n,(function(e){return e.y}))})).entries(n)})),t.variable(n("key")).define("key",["md"],(function(e){return e(P())})),t}function U(){var e=o(["= "," kwh per day"]);return U=function(){return e},e}function C(){var e=o(["\nYou take \n"," \nshower(s) a day averaging \n"," \nminutes with water flow of \n","\nml per second \n"]);return C=function(){return e},e}function B(){var e=o(["# Showers"]);return B=function(){return e},e}function H(e,n){var t=e.module();t.variable(n()).define(["md"],(function(e){return e(B())})),t.variable(n("showers_and_baths_text")).define("showers_and_baths_text",["md","inline_input","viewof num_showers","viewof shower_minutes","viewof shower_flow"],(function(e,n,t,i,r){return e(C(),n(t),n(i),n(r,"number","45px"))})),t.variable(n("kwh")).define("kwh",["eu","shower_minutes","shower_flow","num_showers"],(function(e,n,t,i){return e.shower.get_daily_kwh(n,t,i)})),t.variable(n("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,n){return e.utils.format_kwh(n)})),t.variable(n("shower_conclusion")).define("shower_conclusion",["md","kwh"],(function(e,n){return e(U(),n)})),t.variable(n("shower_data")).define("shower_data",["kwh"],(function(e){return[{name:"Showers",value:e}]})),t.variable(n("showers_and_baths_chart")).define("showers_and_baths_chart",["unit_chart","kwh"],(function(e,n){return e({Showers:n})})),t.variable(n("viewof num_showers")).define("viewof num_showers",["View"],(function(e){return new e(2)})),t.variable(n("num_showers")).define("num_showers",["Generators","viewof num_showers"],(function(e,n){return e.input(n)})),t.variable(n("viewof shower_minutes")).define("viewof shower_minutes",["View"],(function(e){return new e(4)})),t.variable(n("shower_minutes")).define("shower_minutes",["Generators","viewof shower_minutes"],(function(e,n){return e.input(n)})),t.variable(n("viewof shower_flow")).define("viewof shower_flow",["View"],(function(e){return new e(135)})),t.variable(n("shower_flow")).define("shower_flow",["Generators","viewof shower_flow"],(function(e,n){return e.input(n)}));var i=e.module(O);t.import("bind",i),t.import("View",i);var r=e.module(R);t.import("inline_input",r),t.variable(n("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.22")}));var a=e.module(F);return t.import("unit_chart",a),t}function Y(){var e=o(["= "," kwh per day"]);return Y=function(){return e},e}function Q(){var e=o([" You drive an average \n"," \nmiles per \n"," in a vehicle that gets an average of \n","\nmiles per imperial gallon"]);return Q=function(){return e},e}function J(){var e=o(["# Driving"]);return J=function(){return e},e}function K(e,n){var t=e.module();t.variable(n()).define(["md"],(function(e){return e(J())}));var i=e.module(O);t.import("bind",i),t.import("View",i);var r=e.module(R);t.import("inline_input",r),t.import("time_period_picker",r);var a=e.module(F);return t.import("unit_chart",a),t.variable(n("driving_text")).define("driving_text",["md","inline_input","viewof miles","time_period_picker","viewof miles_driven_period","viewof miles_per_gallon"],(function(e,n,t,i,r,a){return e(Q(),n(t,"number","60px"),i(r),n(a,"number","45px"))})),t.variable(n("kwh")).define("kwh",["eu","miles","miles_driven_period","miles_per_gallon"],(function(e,n,t,i){return e.driving.miles_driven_to_kwh_per_day(n,t,i)})),t.variable(n("driving_chart")).define("driving_chart",["unit_chart","kwh"],(function(e,n){return e({Driving:n})})),t.variable(n("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,n){return e.utils.format_kwh(n)})),t.variable(n("driving_conclusion")).define("driving_conclusion",["md","kwh_formatted"],(function(e,n){return e(Y(),n)})),t.variable(n("driving_data")).define("driving_data",["kwh"],(function(e){return[{name:"Driving",value:e}]})),t.variable(n("viewof miles")).define("viewof miles",["View"],(function(e){return new e(1e4)})),t.variable(n("miles")).define("miles",["Generators","viewof miles"],(function(e,n){return e.input(n)})),t.variable(n("viewof miles_per_gallon")).define("viewof miles_per_gallon",["View"],(function(e){return new e(45)})),t.variable(n("miles_per_gallon")).define("miles_per_gallon",["Generators","viewof miles_per_gallon"],(function(e,n){return e.input(n)})),t.variable(n("viewof miles_driven_period")).define("viewof miles_driven_period",["View"],(function(e){return new e("years")})),t.variable(n("miles_driven_period")).define("miles_driven_period",["Generators","viewof miles_driven_period"],(function(e,n){return e.input(n)})),t.variable(n("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.22")})),t}function Z(){var e=o(["= "," kwh per day"]);return Z=function(){return e},e}function X(){var e=o([" You fly an average of\n"," \nmiles per \n","\nin economy class.  (Business class/first class would probably be double this or more)\n"]);return X=function(){return e},e}function $(){var e=o(["# Flying"]);return $=function(){return e},e}function ee(e,n){var t=e.module();t.variable(n()).define(["md"],(function(e){return e($())}));var i=e.module(O);t.import("bind",i),t.import("View",i);var r=e.module(R);t.import("inline_input",r),t.import("time_period_picker",r),t.variable(n("flying_text")).define("flying_text",["md","inline_input","viewof miles","time_period_picker","viewof miles_flown_period"],(function(e,n,t,i,r){return e(X(),n(t,"number","60px"),i(r))})),t.variable(n("kwh")).define("kwh",["eu","miles","miles_flown_period"],(function(e,n,t){return e.flying.flying_miles_to_kwh(n,t)})),t.variable(n("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,n){return e.utils.format_kwh(n)})),t.variable(n("flying_conclusion")).define("flying_conclusion",["md","kwh_formatted"],(function(e,n){return e(Z(),n)})),t.variable(n("flying_chart")).define("flying_chart",["unit_chart","kwh"],(function(e,n){return e({Flying:n})})),t.variable(n("flying_data")).define("flying_data",["kwh"],(function(e){return[{name:"Flying",value:e}]})),t.variable(n("viewof miles")).define("viewof miles",["View"],(function(e){return new e(12e3)})),t.variable(n("miles")).define("miles",["Generators","viewof miles"],(function(e,n){return e.input(n)})),t.variable(n("viewof miles_flown_period")).define("viewof miles_flown_period",["View"],(function(e){return new e("years")})),t.variable(n("miles_flown_period")).define("miles_flown_period",["Generators","viewof miles_flown_period"],(function(e,n){return e.input(n)})),t.variable(n("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.22")}));var a=e.module(F);return t.import("unit_chart",a),t}function ne(){var e=o(["= \n"," kwh per day"]);return ne=function(){return e},e}function te(){var e=o(["\nYou run the washing machine \n"," \ntimes a \n"," \nand the dishwasher \n","\ntimes a \n","\n"]);return te=function(){return e},e}function ie(){var e=o(["# Washing machine and dishwasher"]);return ie=function(){return e},e}function re(e,n){var t=e.module();t.variable(n()).define(["md"],(function(e){return e(ie())})),t.variable(n("washing_text")).define("washing_text",["md","inline_input","viewof num_washing_machine","time_period_picker","viewof washing_machine_period","viewof num_dishwasher","viewof dishwasher_period"],(function(e,n,t,i,r,a,o){return e(te(),n(t),i(r),n(a),i(o))})),t.variable(n("wm")).define("wm",["eu","num_washing_machine","washing_machine_period"],(function(e,n,t){return e.washing.washing_machine_kwh_per_day(n,t,30)})),t.variable(n("dw")).define("dw",["eu","num_dishwasher","dishwasher_period"],(function(e,n,t){return e.washing.dishwasher_kwh_per_day(n,t,50)})),t.variable(n("kwh")).define("kwh",["wm","dw"],(function(e,n){return e+n})),t.variable(n("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,n){return e.utils.format_kwh(n)})),t.variable(n("washing_conclusion")).define("washing_conclusion",["md","kwh_formatted"],(function(e,n){return e(ne(),n)})),t.variable(n("washing_chart")).define("washing_chart",["unit_chart","wm","dw"],(function(e,n,t){return e({"Washing machine":n,Dishwasher:t})})),t.variable(n("washing_data")).define("washing_data",["wm","dw"],(function(e,n){return[{name:"Washing machine",value:e},{name:"Dishwasher",value:n}]})),t.variable(n("viewof num_washing_machine")).define("viewof num_washing_machine",["View"],(function(e){return new e(2)})),t.variable(n("num_washing_machine")).define("num_washing_machine",["Generators","viewof num_washing_machine"],(function(e,n){return e.input(n)})),t.variable(n("viewof washing_machine_period")).define("viewof washing_machine_period",["View"],(function(e){return new e("weeks")})),t.variable(n("washing_machine_period")).define("washing_machine_period",["Generators","viewof washing_machine_period"],(function(e,n){return e.input(n)})),t.variable(n("viewof dishwasher_period")).define("viewof dishwasher_period",["View"],(function(e){return new e("weeks")})),t.variable(n("dishwasher_period")).define("dishwasher_period",["Generators","viewof dishwasher_period"],(function(e,n){return e.input(n)})),t.variable(n("viewof num_dishwasher")).define("viewof num_dishwasher",["View"],(function(e){return new e(4)})),t.variable(n("num_dishwasher")).define("num_dishwasher",["Generators","viewof num_dishwasher"],(function(e,n){return e.input(n)}));var i=e.module(O);t.import("bind",i),t.import("View",i);var r=e.module(R);t.import("inline_input",r),t.import("time_period_picker",r),t.variable(n("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.22")}));var a=e.module(F);return t.import("unit_chart",a),t}function ae(){var e=o(["= "," kwh per day"]);return ae=function(){return e},e}function oe(){var e=o([" You have \n"," \ndog(s) who weigh \n"," \nkg each (on average)\n"]);return oe=function(){return e},e}function ue(){var e=o(["# Pets"]);return ue=function(){return e},e}function le(e,n){var t=e.module();t.variable(n()).define(["md"],(function(e){return e(ue())}));var i=e.module(O);t.import("bind",i),t.import("View",i);var r=e.module(R);t.import("inline_input",r),t.import("time_period_picker",r),t.variable(n("dogs_text")).define("dogs_text",["md","inline_input","viewof num_dogs","viewof dogs_weight_kg"],(function(e,n,t,i){return e(oe(),n(t,"number"),n(i,"number","50px"))})),t.variable(n("kwh")).define("kwh",["num_dogs","eu","dogs_weight_kg"],(function(e,n,t){return e*n.pets.kwh_required_by_dogs_per_day(t)})),t.variable(n("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,n){return e.utils.format_kwh(n)})),t.variable(n("dogs_chart")).define("dogs_chart",["unit_chart","kwh"],(function(e,n){return e({Dogs:n})})),t.variable(n("dogs_conclusion")).define("dogs_conclusion",["md","kwh_formatted"],(function(e,n){return e(ae(),n)})),t.variable(n("dogs_data")).define("dogs_data",["kwh"],(function(e){return[{name:"Dogs",value:e}]})),t.variable(n("viewof num_dogs")).define("viewof num_dogs",["View"],(function(e){return new e(1)})),t.variable(n("num_dogs")).define("num_dogs",["Generators","viewof num_dogs"],(function(e,n){return e.input(n)})),t.variable(n("viewof dogs_weight_kg")).define("viewof dogs_weight_kg",["View"],(function(e){return new e(15)})),t.variable(n("dogs_weight_kg")).define("dogs_weight_kg",["Generators","viewof dogs_weight_kg"],(function(e,n){return e.input(n)})),t.variable(n("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.22")}));var a=e.module(F);return t.import("unit_chart",a),t}function ce(){var e=o(['<select>\n    <option value="omnivore">Omnivore</option>\n    <option value="vegetarian">Vegetarian</option>\n    <option value="vegan">Vegan</option>\n  </select>']);return ce=function(){return e},e}function fe(){var e=o(['<select>\n    <option value="male">Male</option>\n    <option value="female">Female</option>\n  </select>']);return fe=function(){return e},e}function de(){var e=o(['<select>\n    <option value="sedentary_light">Sedentary/lightly active</option>\n    <option value="moderately_active">Moderately active</option>\n    <option value="vigorous">Vigorous</option>\n  </select>']);return de=function(){return e},e}function se(){var e=o(["= "," kwh per day"]);return se=function(){return e},e}function ve(){var e=o([" You are \n"," \ncm high, \nyou are \n"," \nyears old,\nyou weigh\n"," \nkg,\nyou're\n"," \nand you have a \n"," \nlifestyle, and your diet type is \n","\n"]);return ve=function(){return e},e}function he(){var e=o(["# Eating"]);return he=function(){return e},e}function me(e,n){var t=e.module();t.variable(n()).define(["md"],(function(e){return e(he())}));var i=e.module(O);t.import("bind",i),t.import("View",i);var r=e.module(R);t.import("inline_input",r),t.import("time_period_picker",r),t.variable(n("eating_text")).define("eating_text",["md","inline_input","viewof height_cm","viewof age_years","viewof weight_kg","gender_picker","viewof gender","activity_level_picker","viewof activity_level","diet_picker","viewof diet_type"],(function(e,n,t,i,r,a,o,u,l,c,f){return e(ve(),n(t,"number","60px"),n(i,"number","50px"),n(r,"number","60px"),a(o),u(l),c(f))})),t.variable(n("kwh")).define("kwh",["eu","weight_kg","height_cm","age_years","gender","activity_level","diet_type"],(function(e,n,t,i,r,a,o){return e.eating.kwh_per_day(n,t,i,r,a,o)})),t.variable(n("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,n){return e.utils.format_kwh(n)})),t.variable(n("eating_chart")).define("eating_chart",["unit_chart","kwh"],(function(e,n){return e({"Food/Eating":n})})),t.variable(n("eating_conclusion")).define("eating_conclusion",["md","kwh_formatted"],(function(e,n){return e(se(),n)})),t.variable(n("eating_data")).define("eating_data",["kwh"],(function(e){return[{name:"Food/Eating",value:e}]})),t.variable(n("viewof weight_kg")).define("viewof weight_kg",["View"],(function(e){return new e(68)})),t.variable(n("weight_kg")).define("weight_kg",["Generators","viewof weight_kg"],(function(e,n){return e.input(n)})),t.variable(n("viewof height_cm")).define("viewof height_cm",["View"],(function(e){return new e(178)})),t.variable(n("height_cm")).define("height_cm",["Generators","viewof height_cm"],(function(e,n){return e.input(n)})),t.variable(n("viewof age_years")).define("viewof age_years",["View"],(function(e){return new e(34)})),t.variable(n("age_years")).define("age_years",["Generators","viewof age_years"],(function(e,n){return e.input(n)})),t.variable(n("viewof gender")).define("viewof gender",["View"],(function(e){return new e("male")})),t.variable(n("gender")).define("gender",["Generators","viewof gender"],(function(e,n){return e.input(n)})),t.variable(n("viewof activity_level")).define("viewof activity_level",["View"],(function(e){return new e("moderately_active")})),t.variable(n("activity_level")).define("activity_level",["Generators","viewof activity_level"],(function(e,n){return e.input(n)})),t.variable(n("viewof diet_type")).define("viewof diet_type",["View"],(function(e){return new e("omnivore")})),t.variable(n("diet_type")).define("diet_type",["Generators","viewof diet_type"],(function(e,n){return e.input(n)})),t.variable(n("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.25")})),t.variable(n("activity_level_picker")).define("activity_level_picker",["bind","html"],(function(e,n){return function(t){return e(n(de()),t)}})),t.variable(n("gender_picker")).define("gender_picker",["bind","html"],(function(e,n){return function(t){return e(n(fe()),t)}})),t.variable(n("diet_picker")).define("diet_picker",["bind","html"],(function(e,n){return function(t){return e(n(ce()),t)}}));var a=e.module(F);return t.import("unit_chart",a),t}function pe(){var e=o(['<select>\n    <option value="kwh">kwh</option>\n    <option value="imperial_units">Imperial units (100s of cubic feet)</option>\n    <option value="metric_units">Metrics units</option>\n  </select>']);return pe=function(){return e},e}function _e(){var e=o(["= "," kwh per day"]);return _e=function(){return e},e}function we(){var e=o([" Your energy bill says you use \n"," \n"," \nper year and there are \n"," \npeople in your household.\nOver that billing period, your thermostat was set to around:\n"," \ndegrees centigrade.\n\nIn future, you expect to set your thermostat to \n"," \ndegrees centigrate.  Your future use is expected to be:\n"]);return we=function(){return e},e}function ge(){var e=o(["# Heating"]);return ge=function(){return e},e}function be(e,n){var t=e.module();t.variable(n()).define(["md"],(function(e){return e(ge())}));var i=e.module(O);t.import("bind",i),t.import("View",i);var r=e.module(R);t.import("inline_input",r),t.variable(n("heating_text")).define("heating_text",["md","inline_input","viewof actual_usage_from_bill","units_picker","viewof bill_units","viewof num_occupants","viewof thermostat_current","viewof thermostat_future"],(function(e,n,t,i,r,a,o,u){return e(we(),n(t,"number","60px"),i(r),n(a,"number","45px"),n(o,"number","45px"),n(u,"number","45px"))})),t.variable(n("kwh")).define("kwh",["eu","actual_usage_from_bill","thermostat_current","thermostat_future","num_occupants","bill_units"],(function(e,n,t,i,r,a){return e.heating.heating_kwh_per_day(n,t,i,r,a)})),t.variable(n("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,n){return e.utils.format_kwh(n)})),t.variable(n("heating_conclusion")).define("heating_conclusion",["md","kwh_formatted"],(function(e,n){return e(_e(),n)})),t.variable(n("heating_data")).define("heating_data",["kwh"],(function(e){return[{name:"Heating",value:e}]})),t.variable(n("heating_chart")).define("heating_chart",["unit_chart","kwh"],(function(e,n){return e({Heating:n})})),t.variable(n("viewof actual_usage_from_bill")).define("viewof actual_usage_from_bill",["View"],(function(e){return new e(597)})),t.variable(n("actual_usage_from_bill")).define("actual_usage_from_bill",["Generators","viewof actual_usage_from_bill"],(function(e,n){return e.input(n)})),t.variable(n("viewof bill_units")).define("viewof bill_units",["View"],(function(e){return new e("metric_units")})),t.variable(n("bill_units")).define("bill_units",["Generators","viewof bill_units"],(function(e,n){return e.input(n)})),t.variable(n("viewof thermostat_current")).define("viewof thermostat_current",["View"],(function(e){return new e(19)})),t.variable(n("thermostat_current")).define("thermostat_current",["Generators","viewof thermostat_current"],(function(e,n){return e.input(n)})),t.variable(n("viewof thermostat_future")).define("viewof thermostat_future",["View"],(function(e){return new e(19)})),t.variable(n("thermostat_future")).define("thermostat_future",["Generators","viewof thermostat_future"],(function(e,n){return e.input(n)})),t.variable(n("viewof num_occupants")).define("viewof num_occupants",["View"],(function(e){return new e(2)})),t.variable(n("num_occupants")).define("num_occupants",["Generators","viewof num_occupants"],(function(e,n){return e.input(n)})),t.variable(n("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.29")})),t.variable(n("units_picker")).define("units_picker",["bind","html"],(function(e,n){return function(t){return e(n(pe()),t)}}));var a=e.module(F);return t.import("unit_chart",a),t}function ye(){var e=o(["= "," kwh per day"]);return ye=function(){return e},e}function ke(){var e=o([" You spend an average of \n£ "," \nper ","\non 'stuff'.\n\n('Stuff' includes things like clothes, electronics, white goods and cars, but excludes items otherwise accounted for such as food, petrol and flights)\n"]);return ke=function(){return e},e}function xe(){var e=o(["# Stuff"]);return xe=function(){return e},e}function Ae(e,n){var t=e.module();t.variable(n()).define(["md"],(function(e){return e(xe())}));var i=e.module(O);t.import("bind",i),t.import("View",i);var r=e.module(R);t.import("inline_input",r),t.import("time_period_picker",r),t.variable(n("stuff_text")).define("stuff_text",["md","inline_input","viewof spending","time_period_picker","viewof spending_time_period"],(function(e,n,t,i,r){return e(ke(),n(t,"number","60px"),i(r))})),t.variable(n("kwh")).define("kwh",["eu","spending","spending_time_period"],(function(e,n,t){return e.stuff.pounds_sterling_to_kwh(n)/e.convert.convert_units(t,"days")})),t.variable(n("kwh_formatted")).define("kwh_formatted",["eu","kwh"],(function(e,n){return e.utils.format_kwh(n)})),t.variable(n("stuff_conclusion")).define("stuff_conclusion",["md","kwh_formatted"],(function(e,n){return e(ye(),n)})),t.variable(n("stuff_chart")).define("stuff_chart",["unit_chart","kwh"],(function(e,n){return e({Stuff:n})})),t.variable(n("stuff_data")).define("stuff_data",["kwh"],(function(e){return[{name:"Stuff",value:e}]})),t.variable(n("viewof spending")).define("viewof spending",["View"],(function(e){return new e(500)})),t.variable(n("spending")).define("spending",["Generators","viewof spending"],(function(e,n){return e.input(n)})),t.variable(n("viewof spending_time_period")).define("viewof spending_time_period",["View"],(function(e){return new e("months")})),t.variable(n("spending_time_period")).define("spending_time_period",["Generators","viewof spending_time_period"],(function(e,n){return e.input(n)})),t.variable(n("eu")).define("eu",["require"],(function(e){return e("@robinl/energy_usage@0.0.31")}));var a=e.module(F);return t.import("unit_chart",a),t}t(45);function Ve(){var e=o(["You use a total of __"," kilowatt hours__ of energy a day from the activities covered on this webpage. This means your average power consumption is "," watts.  This is the equivalent of around "," humans continously doing strenous exercise on your behalf."]);return Ve=function(){return e},e}function Ge(){var e=o(["# Energy usage treemap and summary"]);return Ge=function(){return e},e}function Se(e,n){var t=e.module();return t.variable(n()).define(["md"],(function(e){return e(Ge())})),t.variable(n("summary_text")).define("summary_text",["get_total","md","format"],(function(e,n,t){return function(i){var r=e(i),a=r/24*1e3;return n(Ve(),t(r),t(a),t(a/100))}})),t.variable(n("get_total")).define("get_total",(function(){return function(e){return e.reduce((function(e,n){return e+n.value}),0)}})),t.variable(n("my_data")).define("my_data",(function(){return[{name:"Showers",value:2.5104},{name:"Driving",value:26.293975646879755},{name:"Flying",value:13.425863835616436},{name:"Washing machine",value:.19999999999999998},{name:"Dishwasher",value:.6},{name:"Food/Eating",value:23.303485333333334},{name:"Dogs",value:8.86730602373828}]})),t.variable(n()).define(["chart","my_data"],(function(e,n){return e(n)})),t.variable(n("chart")).define("chart",["treemap","d3","width","format","DOM","color","per_fmt"],(function(e,n,t,i,r,a,o){return function(u){var l=e({name:"root",children:u}),c=4*u.reduce((function(e,n){return e+n.value}),0),f=n.create("svg").attr("width",t).attr("height",c).style("font","10px sans-serif"),d=f.selectAll("g").data(l.leaves()).join("g").attr("transform",(function(e){return"translate(".concat(e.x0,",").concat(e.y0,")")}));return d.append("title").text((function(e){return"".concat(e.ancestors().reverse().map((function(e){return e.data.name})).join("/"),"\n").concat(i(e.value))})),d.append("rect").attr("id",(function(e){return(e.leafUid=r.uid("leaf")).id})).attr("fill",(function(e){for(;e.depth>1;)e=e.parent;return a(e.data.name)})).attr("fill-opacity",.6).attr("width",(function(e){return e.x1-e.x0})).attr("height",(function(e){return e.y1-e.y0})),d.append("clipPath").attr("id",(function(e){return(e.clipUid=r.uid("clip")).id})).append("use").attr("xlink:href",(function(e){return e.leafUid.href})),d.append("text").attr("clip-path",(function(e){return e.clipUid})).selectAll("tspan").data((function(e){return e.data.name.split(/(?=[A-Z][^A-Z])/g).concat(i(e.value)+" kwh").concat(o(e.value/e.parent.value))})).join("tspan").attr("x",3).attr("y",(function(e,n,t){return"".concat(.3*(n===t.length-1)+1.1+.9*n,"em")})).attr("fill-opacity",(function(e,n,t){return n===t.length-1?.7:null})).text((function(e){return e})),f.node()}})),t.variable(n("treemap")).define("treemap",["d3","width"],(function(e,n){return function(t){var i=4*t.children.reduce((function(e,n){return e+n.value}),0);return e.treemap().tile(e.treemapBinary).size([n,i]).padding(1).round(!0)(e.hierarchy(t).sum((function(e){return e.value})).sort((function(e,n){return n.value-e.value})))}})),t.variable(n("width")).define("width",(function(){return 600})),t.variable(n("format")).define("format",["d3"],(function(e){return e.format(",.3r")})),t.variable(n("per_fmt")).define("per_fmt",["d3"],(function(e){return e.format(",.1%")})),t.variable(n("color")).define("color",["d3"],(function(e){return e.scaleOrdinal(e.schemeCategory10)})),t.variable(n("d3")).define("d3",["require"],(function(e){return e("d3@5")})),t}var De=t(35);function je(){var e=o(["## Parallel Coordinates\n\nA [parallel coordinates plot](https://en.wikipedia.org/wiki/Parallel_coordinates) that uses `window` and `fold` transforms to convert the four dimensions of Iris flower measurements into normalized coordinates that can be visualized as `line` marks. The graphic includes an additional layer with custom `text` mark labels for the parallel axis grid lines. We render the plot as SVG by passing `{renderer:'svg'}` to the `render` method.\n"],["## Parallel Coordinates\n\nA [parallel coordinates plot](https://en.wikipedia.org/wiki/Parallel_coordinates) that uses \\`window\\` and \\`fold\\` transforms to convert the four dimensions of Iris flower measurements into normalized coordinates that can be visualized as \\`line\\` marks. The graphic includes an additional layer with custom \\`text\\` mark labels for the parallel axis grid lines. We render the plot as SVG by passing \\`{renderer:'svg'}\\` to the \\`render\\` method.\n"]);return je=function(){return e},e}function Te(){var e=o(["## Interactive Seattle Weather 2012-2015\n\nA scatter plot and summary histogram with linked `selections` between plots to perform cross-filtering and configure conditional color encodings.\n"],["## Interactive Seattle Weather 2012-2015\n\nA scatter plot and summary histogram with linked \\`selections\\` between plots to perform cross-filtering and configure conditional color encodings.\n"]);return Te=function(){return e},e}function Ee(){var e=o(["## Zip Codes\n\nA dot for each zip code in the United States, colored by the first digit.\n"]);return Ee=function(){return e},e}function Le(){var e=o(["To use the same setup in your own notebooks, add a cell with the following code:\n~~~ js\nimport {vl} from '@vega/vega-lite-api'\n~~~\n"]);return Le=function(){return e},e}function qe(){var e=o(["\nThe cell below imports the Vega-Lite API and registers the desired versions of Vega and Vega-Lite, along with default [Vega View options](https://vega.github.io/vega/docs/api/view/#view) and [Vega-Lite configuration](https://vega.github.io/vega-lite/docs/config.html):\n"]);return qe=function(){return e},e}function Oe(){var e=o(["The [Vega-Lite JavaScript API](https://github.com/vega/vega-lite-api/) provides a convenient way to write [Vega-Lite](https://vega.github.io/vega-lite) specifications in a programmatic fashion. Scroll down for some usage examples, or browse the [Vega-Lite API example collection](https://observablehq.com/collection/@vega/vega-lite-api)!"]);return Oe=function(){return e},e}function Ne(){var e=o(["# Vega-Lite API"]);return Ne=function(){return e},e}function ze(e,n){var t=e.module();return t.variable(n()).define(["md"],(function(e){return e(Ne())})),t.variable(n()).define(["md"],(function(e){return e(Oe())})),t.variable(n()).define(["md"],(function(e){return e(qe())})),t.variable(n("vl")).define("vl",["require"],function(){var e=Object(a.a)(r.a.mark((function e(n){var t,i,a,o,u,l,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(["vega@5","vega-lite@3.4.0","vega-lite-api@0.1.0","vega-tooltip@0.17.0"].map((function(e){return n(e)})));case 2:return t=e.sent,i=Object(De.a)(t,4),a=i[0],o=i[1],u=i[2],l=i[3],c={config:{config:{view:{width:400,height:300},mark:{tooltip:null}}},init:function(e){e.tooltip((new l.Handler).call),e.container()&&(e.container().style["overflow-x"]="auto")},view:{loader:a.loader({baseURL:"https://vega.github.io/vega-datasets/"}),renderer:"canvas"}},e.abrupt("return",u.register(a,o,c));case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),t.variable(n()).define(["md"],(function(e){return e(Le())})),t.variable(n()).define(["md"],(function(e){return e(Ee())})),t.variable(n()).define(["vl","width"],(function(e,n){return e.markSquare({size:2,opacity:1}).data("data/zipcodes.csv").transform(e.calculate("substring(datum.zip_code, 0, 1)").as("digit")).project(e.projection("albersUsa")).encode(e.longitude().fieldQ("longitude"),e.latitude().fieldQ("latitude"),e.color().fieldN("digit")).width(n).height(Math.floor(n/1.75)).autosize({type:"fit-x",contains:"padding"}).config({view:{stroke:null}}).render()})),t.variable(n()).define(["md"],(function(e){return e(Te())})),t.variable(n()).define(["vl","width"],(function(e,n){var t=e.selectInterval().encodings("x"),i=e.selectMulti().encodings("color"),r={domain:["sun","fog","drizzle","rain","snow"],range:["#e7ba52","#a7a7a7","#aec7e8","#1f77b4","#9467bd"]},a=e.markPoint({filled:!0}).encode(e.color().value("lightgray").if(t,e.color().fieldN("weather").scale(r).title("Weather")),e.size().fieldQ("precipitation").scale({domain:[-1,50],range:[10,500]}).title("Precipitation"),e.order().fieldQ("precipitation").sort("descending"),e.x().timeMD("date").axis({title:"Date",format:"%b"}),e.y().fieldQ("temp_max").scale({domain:[-5,40]}).axis({title:"Maximum Daily Temperature (°C)"})).width(n).height(300).select(t).transform(e.filter(i)),o=e.markBar().encode(e.color().value("lightgray").if(i,e.color().fieldN("weather").scale(r).title("Weather")),e.x().count(),e.y().fieldN("weather").scale({domain:r.domain}).title("Weather")).width(n).select(i).transform(e.filter(t));return e.vconcat(a,o).data("data/seattle-weather.csv").autosize({type:"fit-x",contains:"padding"}).render()})),t.variable(n()).define(["md"],(function(e){return e(je())})),t.variable(n()).define(["vl","width"],(function(e,n){var t=e.markLine({strokeWidth:1.5,opacity:.5}).encode(e.color().fieldN("species").sort("descending"),e.detail().fieldN("index"),e.x().fieldO("key").scale({type:"point",padding:0}).axis({domain:!1,ticks:!1,title:!1,grid:!0,gridColor:"#888",labelAngle:0,labelPadding:8,labelFontWeight:"bold"}),e.y().fieldQ("fraction").axis(null)),i=e.markText({dx:-2,align:"right",baseline:"middle"}).transform(e.groupby("key").aggregate(e.min("value").as("min"),e.max("value").as("max")),e.fold("min","max").as("op","value"),e.groupby("key").window(e.percent_rank("value").as("fraction"))).encode(e.x().fieldN("key"),e.y().fieldQ("fraction").axis(null),e.text().fieldN("value"));return e.layer(t,i).data("data/iris.json").transform(e.window(e.row_number().as("index")),e.fold(["petalLength","petalWidth","sepalLength","sepalWidth"]),e.groupby("key").join(e.min("value").as("min"),e.max("value").as("max")),e.calculate("(datum.value - datum.min) / (datum.max - datum.min)").as("fraction")).width(n).height(300).autosize({type:"fit-x",contains:"padding"}).render({renderer:"svg"})})),t}function Ie(){var e=o(["Data comes from a custom report generated from the World Development Indicators, [here](https://databank.worldbank.org/reports.aspx?source=world-development-indicators#)"]);return Ie=function(){return e},e}function Re(){var e=o(["https://datacatalog.worldbank.org/energy-use-kg-oil-equivalent-capita-1\nhttps://datacatalog.worldbank.org/total-final-energy-consumption-tfec\n\nNot clear from either measure what it contains -e.g. presumably it doesn't contain energy embodied in imported goods?\n"]);return Re=function(){return e},e}function Pe(){var e=o(["# Derive energy usage country comparisons"]);return Pe=function(){return e},e}function Me(e,n){var t=e.module();t.variable(n()).define(["md"],(function(e){return e(Pe())})),t.variable(n()).define(["md"],(function(e){return e(Re())})),t.variable(n("d3")).define("d3",["require"],(function(e){return e("d3")})),t.variable(n()).define(["md"],(function(e){return e(Ie())})),t.variable(n("url")).define("url",(function(){return"https://gist.githubusercontent.com/RobinL/f9d478dadd70ec2dda67c1e9e91686f1/raw/1d628cb38f3d693052bf6bf5eedcb4126bf34a25/energy_usage.csv"})),t.variable(n("data")).define("data",["d3","url"],(function(e,n){return e.csv(n,e.autoType)})),t.variable(n("nonnull_data")).define("nonnull_data",["data"],(function(e){return e.filter((function(e){return".."!=e["2014 [YR2014]"]}))})),t.variable(n("data_by_country")).define("data_by_country",["nonnull_data"],(function(e){return e.map((function(e){var n={};return n["2014_kg_oil_equiv_per_capita"]=e["2014 [YR2014]"],n.country=e["Country Name"],n.code=e["Country Code"],n}))})),t.variable(n("data_with_kwh")).define("data_with_kwh",["data_by_country"],(function(e){return e.map((function(e){return e.kwh_per_day=11.63*e["2014_kg_oil_equiv_per_capita"]/365,{kwh_per_day:e.kwh_per_day,code:e.code,country:e.country}}))})),t.variable(n("countries")).define("countries",(function(){return["USA","GBR","CHN","FRA","BRA","IND","AUS"]})),t.variable(n("selected_countries")).define("selected_countries",["data_with_kwh","countries"],(function(e,n){return e.filter((function(e){return n.includes(e.code)}))})),t.variable(n()).define(["selected_countries"],(function(e){return JSON.stringify(e)})),t.variable(n("primary_energy_use_data_pc")).define("primary_energy_use_data_pc",["d3"],(function(e){return e.json("https://cors-anywhere.herokuapp.com/http://api.worldbank.org/countries/USA;GBR;CHN;FRA;BRA;IND;AUS/indicators/EG.USE.PCAP.KG.OE?date=2014%3A2014&format=json&per_page=1000")})),t.variable(n("tfec_data")).define("tfec_data",["d3"],(function(e){return e.json("https://cors-anywhere.herokuapp.com/http://api.worldbank.org/countries/USA;GBR;CHN;FRA;BRA;IND;AUS/indicators/1.1_TOTAL.FINAL.ENERGY.CONSUM?date=2014%3A2014&format=json&per_page=1000")})),t.variable(n("population_data")).define("population_data",["d3"],(function(e){return e.json("https://cors-anywhere.herokuapp.com/http://api.worldbank.org/countries/USA;GBR;CHN;FRA;BRA;IND;AUS/indicators/SP.POP.TOTL?date=2014%3A2014&format=json&per_page=1000")})),t.variable(n("final_energy_use_per_capita_data")).define("final_energy_use_per_capita_data",["tfec_data","population_data"],(function(e,n){return[0,1,2,3,4,5,6].map((function(t){return{code:e[1][t].country.id,country:e[1][t].country.value,kwh_per_day:1e12*e[1][t].value/(36e5*n[1][t].value)/365.25}}))})),t.variable(n("primary_energy_use_per_capita_data")).define("primary_energy_use_per_capita_data",["primary_energy_use_data_pc"],(function(e){return e[1].map((function(e){return e.kwh_per_day=11.63*e.value/365,{kwh_per_day:e.kwh_per_day,code:e.country.id,country:e.country.value}}))}));var i=e.module(ze);return t.import("vl",i),t.variable(n("vega_embed")).define("vega_embed",["require"],(function(e){return e("vega-embed@3")})),t.variable(n("primary_energy_use_per_capita")).define("primary_energy_use_per_capita",["vega_embed","primary_energy_use_per_capita_data"],(function(e,n){return e({data:{values:n},mark:"bar",encoding:{x:{field:"country",type:"nominal",sort:{field:"kwh_per_day",op:"mean",order:"descending"}},y:{field:"kwh_per_day",type:"quantitative"}}})})),t.variable(n("final_energy_use_per_capita")).define("final_energy_use_per_capita",["vega_embed","final_energy_use_per_capita_data"],(function(e,n){return e({data:{values:n},mark:"bar",encoding:{x:{field:"country",type:"nominal",sort:{field:"kwh_per_day",op:"mean",order:"descending"}},y:{field:"kwh_per_day",type:"quantitative"}}})})),t}function We(){var e=o(["<a href>"]);return We=function(){return e},e}function Fe(){var e=o(["## Annex: Imports and Calculations"]);return Fe=function(){return e},e}function Ue(){var e=o(["The following chart shows final energy consumption per capita."]);return Ue=function(){return e},e}function Ce(){var e=o(['Note that primary energy usage is __not__ equivalent to the end-user consumption tallied in this calculator.\n\nIt is [defined as](https://ec.europa.eu/eurostat/statistics-explained/index.php/Glossary:Primary_energy_consumption) "The total energy demand of a country. It covers consumption of the energy sector itself, losses during transformation (for example, from oil or gas into electricity) and distribution of energy, and the final consumption by end users". \n\nI think this means it would count both energy produced domestically and primary energy imports in the form of fuel.  But not energy embodied in imported goods.  It is unclear to me whether it would count jet fuel oil for international flights.']);return Ce=function(){return e},e}function Be(){var e=o(["The following chart shows primary per capita energy usage, converted into kwh.  See [here](https://datacatalog.worldbank.org/energy-use-kg-oil-equivalent-capita-1) for the source of the data.  "]);return Be=function(){return e},e}function He(){var e=o(["This calculator only considers a subset of your energy usage, so your overall total will actually be higher.  Nonetheless, it's interesting to compare to average per captia energy usage of various countries:"]);return He=function(){return e},e}function Ye(){var e=o(["## How do you compare?"]);return Ye=function(){return e},e}function Qe(){var e=o(["Here's how your energy usage breaks down:"]);return Qe=function(){return e},e}function Je(){var e=o(["# Summary"]);return Je=function(){return e},e}function Ke(){var e=o(["## [Dogs](https://github.com/RobinL/energy_usage/blob/master/src/pets.js)"]);return Ke=function(){return e},e}function Ze(){var e=o(["## [Washing machine/Dishwasher](https://github.com/RobinL/energy_usage/blob/master/src/washing_dishwasher.js)"]);return Ze=function(){return e},e}function Xe(){var e=o(["## [Eating](https://github.com/RobinL/energy_usage/blob/master/src/eating.js)"]);return Xe=function(){return e},e}function $e(){var e=o(["## [Showers](https://github.com/RobinL/energy_usage/blob/master/src/shower.js)"]);return $e=function(){return e},e}function en(){var e=o(["## [Stuff](https://github.com/RobinL/energy_usage/blob/master/src/stuff.js)"]);return en=function(){return e},e}function nn(){var e=o(["## [Heating](https://github.com/RobinL/energy_usage/blob/master/src/heating.js)"]);return nn=function(){return e},e}function tn(){var e=o(["## [Flying](https://github.com/RobinL/energy_usage/blob/master/src/flying.js)"]);return tn=function(){return e},e}function rn(){var e=o(["## [Driving](https://github.com/RobinL/energy_usage/blob/master/src/driving.js)"]);return rn=function(){return e},e}function an(){var e=o(["## Key to graphics"]);return an=function(){return e},e}function on(){var e=o(["This is a __rough ready reckoner__ to help you understand your energy consumption. \n\nI'm sure these estimates could be significantly improved - pull requests gratefully received [here](https://github.com/RobinL/energy_usage/pulls).\n\nFollowing, [David MacKay](https://www.withouthotair.com/c2/page_24.shtml), I standardise everything in kilowatt hours. \n\nYou can find all assumptions and calculations [here](https://github.com/RobinL/energy_usage/tree/master/src), or click on the headers for calculations specific to each activity.\n"]);return on=function(){return e},e}function un(){var e=o(["# Energy usage ready reckoner for everyday activities"]);return un=function(){return e},e}function ln(e,n){var t=e.module();t.variable(n("title")).define("title",["md"],(function(e){return e(un())})),t.variable(n("under_title_blurb")).define("under_title_blurb",["md"],(function(e){return e(on())})),t.variable(n("key_to_graphics_title")).define("key_to_graphics_title",["md"],(function(e){return e(an())})),t.variable(n("key_to_graphics_text")).define("key_to_graphics_text",["key"],(function(e){return e})),t.variable(n("driving_title")).define("driving_title",["md"],(function(e){return e(rn())})),t.variable(n("driving_text_output")).define("driving_text_output",["driving_text"],(function(e){return e})),t.variable(n("driving_chart_output")).define("driving_chart_output",["driving_chart"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e(tn())})),t.variable(n()).define(["flying_text"],(function(e){return e})),t.variable(n()).define(["flying_chart"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e(nn())})),t.variable(n()).define(["heating_text"],(function(e){return e})),t.variable(n()).define(["heating_chart"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e(en())})),t.variable(n()).define(["stuff_text"],(function(e){return e})),t.variable(n()).define(["stuff_chart"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e($e())})),t.variable(n()).define(["showers_and_baths_text"],(function(e){return e})),t.variable(n()).define(["showers_and_baths_chart"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e(Xe())})),t.variable(n()).define(["eating_text"],(function(e){return e})),t.variable(n()).define(["eating_chart"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e(Ze())})),t.variable(n()).define(["washing_text"],(function(e){return e})),t.variable(n()).define(["washing_chart"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e(Ke())})),t.variable(n()).define(["dogs_text"],(function(e){return e})),t.variable(n()).define(["dogs_chart"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e(Je())})),t.variable(n()).define(["summary_text","all_data"],(function(e,n){return e(n)})),t.variable(n()).define(["unit_chart_2","all_data_dict"],(function(e,n){return e(n)})),t.variable(n()).define(["md"],(function(e){return e(Qe())})),t.variable(n()).define(["chart","all_data"],(function(e,n){return e(n)})),t.variable(n()).define(["md"],(function(e){return e(Ye())})),t.variable(n()).define(["md"],(function(e){return e(He())})),t.variable(n()).define(["md"],(function(e){return e(Be())})),t.variable(n()).define(["primary_energy_use_per_capita"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e(Ce())})),t.variable(n()).define(["md"],(function(e){return e(Ue())})),t.variable(n()).define(["final_energy_use_per_capita"],(function(e){return e})),t.variable(n()).define(["md"],(function(e){return e(Fe())})),t.variable(n("all_data")).define("all_data",["shower_data","driving_data","flying_data","washing_data","eating_data","dogs_data","heating_data","stuff_data"],(function(e,n,t,i,r,a,o,u){return e.concat(n,t,i,r,a,o,u)})),t.variable(n("all_data_dict")).define("all_data_dict",["all_data"],(function(e){var n={};return e.forEach((function(e){return n[e.name]=e.value})),n}));var i=e.module(H);t.import("showers_and_baths_text",i),t.import("shower_conclusion",i),t.import("shower_data",i),t.import("showers_and_baths_chart",i);var o=e.module(K);t.import("driving_text",o),t.import("driving_conclusion",o),t.import("driving_data",o),t.import("driving_chart",o);var u=e.module(ee);t.import("flying_text",u),t.import("flying_chart",u),t.import("flying_data",u);var l=e.module(re);t.import("washing_text",l),t.import("washing_conclusion",l),t.import("washing_data",l),t.import("washing_chart",l);var c=e.module(le);t.import("dogs_text",c),t.import("dogs_conclusion",c),t.import("dogs_data",c),t.import("dogs_chart",c);var f=e.module(me);t.import("eating_text",f),t.import("eating_conclusion",f),t.import("eating_data",f),t.import("eating_chart",f);var d=e.module(be);t.import("heating_text",d),t.import("heating_conclusion",d),t.import("heating_data",d),t.import("heating_chart",d);var s=e.module(Ae);t.import("stuff_text",s),t.import("stuff_conclusion",s),t.import("stuff_data",s),t.import("stuff_chart",s);var v=e.module(Se);t.import("chart",v),t.import("summary_text",v);var h=e.module(Me);t.import("primary_energy_use_per_capita",h),t.import("final_energy_use_per_capita",h);var m=e.module(F);t.import("key",m),t.variable(n("ga")).define("ga",["require","html"],function(){var e=Object(a.a)(r.a.mark((function e(n,t){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n("https://www.google-analytics.com/analytics.js").catch((function(){return window.ga}));case 2:return(i=e.sent)("create","UA-146468274-1","auto"),i("send","pageview",t(We()).pathname),e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}());var p=e.module(F);return t.import("unit_chart",p),t.import("unit_chart_2",p),t}var cn=t(232),fn=["title","under_title_blurb","key_to_graphics_title","driving_title","driving_text_output","driving_chart_output"];n.default=function(e){e.data;return Object(cn.a)(ln,fn)}},238:function(e,n,t){var i=t(3);i(i.P,"Array",{fill:t(127)}),t(99)("fill")}}]);
//# sourceMappingURL=component---src-pages-energy-usage-calculator-for-everyday-activities-js-eb4eed16c861b242ae30.js.map